// This file is automatically generated by Keystone, do not modify it manually.
// Modify your Keystone config when you want to change this.

datasource mysql {
  url               = env("DATABASE_URL")
  shadowDatabaseUrl = env("SHADOW_DATABASE_URL")
  provider          = "mysql"
}

generator client {
  provider = "prisma-client-js"
}

model User {
  id          String       @id @default(cuid())
  name        String       @default("")
  email       String       @unique @default("")
  password    String
  role        UserRoleType @default(STORE_OWNER)
  store       Store?       @relation("Store_owner")
  managedMall Mall?        @relation("Mall_manager")
  payments    Payment[]    @relation("Payment_user")
  createdAt   DateTime?    @default(now())
  updatedAt   DateTime?    @updatedAt
}

model Mall {
  id        String    @id @default(cuid())
  name      String    @default("")
  stores    Store[]   @relation("Store_mall")
  manager   User?     @relation("Mall_manager", fields: [managerId], references: [id])
  managerId String?   @unique @map("manager")
  createdAt DateTime? @default(now())
  updatedAt DateTime? @updatedAt
}

model Store {
  id         String    @id @default(cuid())
  name       String    @default("")
  rentAmount Decimal   @mysql.Decimal(18, 4)
  mall       Mall?     @relation("Store_mall", fields: [mallId], references: [id])
  mallId     String?   @map("mall")
  owner      User?     @relation("Store_owner", fields: [ownerId], references: [id])
  ownerId    String?   @unique @map("owner")
  payments   Payment[] @relation("Payment_store")
  createdAt  DateTime? @default(now())
  updatedAt  DateTime? @updatedAt

  @@index([mallId])
}

model Payment {
  id        String    @id @default(cuid())
  amount    Decimal   @mysql.Decimal(18, 4)
  store     Store?    @relation("Payment_store", fields: [storeId], references: [id])
  storeId   String?   @map("store")
  user      User?     @relation("Payment_user", fields: [userId], references: [id])
  userId    String?   @map("user")
  createdAt DateTime? @default(now())
  updatedAt DateTime? @updatedAt

  @@index([storeId])
  @@index([userId])
}

enum UserRoleType {
  ADMIN
  MANAGER
  STORE_OWNER
}
